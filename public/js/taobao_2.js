$(document).ready(function(){$(window).on('beforeunload',function(){$(window).scrollTop(0);});var widthForTop=$('.main-container').width();$('.top-section').css('width',widthForTop+'px');$(window).resize(function(){var widthForTop=$('.main-container').width();$('.top-section').css('width',widthForTop+'px');});$(window).scroll(function(){$('.top-section').css('padding','6px 0px');var topMargin=$(window).scrollTop();if(topMargin===0){$('.top-section').css('padding','12px 0px');}});$(window).resize(function(){map_resize();});function map_resize(){var map_width=$('#taobao_map_canvas_1').width();$('#taobao_map_canvas_1').css('height',map_width*0.67+'px');}map_resize();});function initialize(){var styles=[{"featureType":"water","elementType":"geometry.fill","stylers":[{"visibility":"on"},{"color":"#000000"},{"saturation":0},{"lightness":20}]},{"featureType":"all","elementType":"labels","stylers":[{"visibility":"off"}]},{"featureType":"road","elementType":"geometry.fill","stylers":[{"visibility":"on"},{"color":"#000000"},{"lightness":0}]},{"featureType":"road","elementType":"geometry.stroke","stylers":[{"visibility":"off"},{"color":"#000000"},{"hue":"#000000"},{"lightness":50}]},{"featureType":"landscape.natural","elementType":"all","stylers":[{"visibility":"on"},{"color":"#000000"}]},{"featureType":"poi.park","elementType":"geometry.fill","stylers":[{"color":"#000000"},{"saturation":0}]},{"featureType":"administrative.province","elementType":"labels","stylers":[{"visibility":"on"},{"color":"#b0b0b0"},{"weight":0.1}]},{"featureType":"administrative.province","elementType":"geometry","stylers":[{"visibility":"on"},{"color":"#e3e3e3"},{"weight":0.5}]},{"featureType":"administrative.locality","elementType":"all","stylers":[{"visibility":"on"},{"color":"#a8a8a8"},{"weight":0.1}]},{"featureType":"administrative.country","elementType":"geometry","stylers":[{"visibility":"on"},{"color":"#000000"},{"weight":0.5}]}]
var styledMap=new google.maps.StyledMapType(styles,{name:"Taobao Village Demo"});var mapOptions={zoom:5,center:new google.maps.LatLng(32.517768,113.240538),disableDefaultUI:true,streetViewControl:false,zoomControl:true,panControl:true,mapTypeControlOptions:{mapTypeIds:[google.maps.MapTypeId.ROADMAP,'map_style']}};var map_1=new google.maps.Map(document.getElementById('taobao_map_canvas_1'),mapOptions);var map_2=new google.maps.Map(document.getElementById('taobao_map_canvas_2'),mapOptions);map_1.mapTypes.set('map_style',styledMap);map_1.setMapTypeId('map_style');map_2.mapTypes.set('map_style',styledMap);map_2.setMapTypeId('map_style');var buyer_marker=[];for(var i=0;i<buyers.length;i++){var buyerLatLng=new google.maps.LatLng(buyers[i].buyerLatitude,buyers[i].buyerLongitude);buyer_marker[i]=new google.maps.Marker({position:buyerLatLng,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:'#d3d3d3',fillOpacity:0.75,scale:buyers[i].包裹数*3,strokeColor:'white',strokeWeight:0,},draggable:false,map:map_1});buyer_marker[i]=new google.maps.Marker({position:buyerLatLng,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:'#e3e3e3',fillOpacity:0,scale:buyers[i].包裹数*3,strokeColor:'white',strokeWeight:0,zIndex:-99},draggable:false,map:map_2});}var village_marker=[];for(var i=0;i<village.length;i++){var villageLatLng=new google.maps.LatLng(village[i].latitude,village[i].longitude);village_marker[i]=new google.maps.Marker({position:villageLatLng,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:'blue',fillOpacity:0.75,scale:village[i].sqrtNumber*0.5,strokeColor:'white',strokeWeight:0,},draggable:false,map:map_1});}var linePath=[];for(var i=0;i<buyers.length;i++){var lineCoordinates=[new google.maps.LatLng(buyers[i].buyerLatitude,buyers[i].buyerLongitude),new google.maps.LatLng(buyers[i].sellerLatitude,buyers[i].sellerLongitude),];var lineColor;var lineOpacity;var pathZIndex;if(buyers[i].淘宝村==='军埔村'){lineColor='#00933C';lineOpacity=0.5;pathZIndex=1}else if(buyers[i].淘宝村==='灶美村'){lineColor='#007AF2';lineOpacity=0.5;pathZIndex=1}else if(buyers[i].淘宝村==='青岩刘村'){lineColor='#FCCC0A';lineOpacity=0.5;pathZIndex=3}else if(buyers[i].淘宝村==='湾头村'){lineColor='#EE352E';lineOpacity=0.5;pathZIndex=2}else if(buyers[i].淘宝村==='白牛村'){lineColor='#ff00ff';lineOpacity=0.5;pathZIndex=4}linePath[i]=new google.maps.Polyline({path:lineCoordinates,geodesic:true,strokeColor:lineColor,strokeOpacity:0.65,strokeWeight:buyers[i].包裹数*3,zIndex:pathZIndex});linePath[i].setMap(map_1);}var pathInfoLat;var pathInfoLng;var pathInfowindow;var prev_pathInfowindow=false;function pathInfoWindowOpen(i){return function(){var buyerPosition=new google.maps.LatLng(pathInfoLat,pathInfoLng);var string='<div class="taobao_map_infowindow">'+buyers[i].淘宝村+' -----> '+buyers[i].买家所在省+buyers[i].买家所在城市+' (Transaction Index: '+buyers[i].包裹数+' )'
'</div>';pathInfowindow=new google.maps.InfoWindow({position:buyerPosition,content:string,disableAutoPan:false});if(prev_pathInfowindow){prev_pathInfowindow.close();}prev_pathInfowindow=pathInfowindow;pathInfowindow.open(map_1,linePath[i]);}}for(var i=0;i<buyers.length;i++){linePath[i].addListener('mouseover',pathInfoWindowOpen(i));}google.maps.event.addListener(map_1,'mousemove',function(event){displayCoordinates(event.latLng);});function displayCoordinates(pnt){pathInfoLat=pnt.lat();pathInfoLat=pathInfoLat.toFixed(4);pathInfoLng=pnt.lng();pathInfoLng=pathInfoLng.toFixed(4);}var double_11_marker=[];for(var i=0;i<double_11.length;i++){var villageLatLng=new google.maps.LatLng(double_11[i].latitude,double_11[i].longitude);var villageColor;if(double_11[i].village==='里仁洞村'){villageColor='#2850AD'}else if(double_11[i].village==='顾家村'){villageColor='#6E3219'}else if(double_11[i].village==='湾头村'){villageColor='#00933C'}else if(double_11[i].village==='军埔村'){villageColor='#FF6319'}else if(double_11[i].village==='白牛村'){villageColor='#6CBE45'}else if(double_11[i].village==='东风村'){villageColor='#996633'}else if(double_11[i].village==='堰下村'){villageColor='#FCCC0A'}else if(double_11[i].village==='灶美村'){villageColor='#EE352E'}else if(double_11[i].village==='北山村'){villageColor='#B933AD'}else if(double_11[i].village==='西岙村'){villageColor='#00A1DE'}double_11_marker[i]=new google.maps.Marker({position:villageLatLng,icon:{path:google.maps.SymbolPath.CIRCLE,fillColor:villageColor,fillOpacity:0.75,scale:double_11[i]['Hour_0']*25,strokeColor:'white',strokeWeight:0.5,zIndex:2},draggable:false,map:map_2});animateMarker(i);}function animateMarker(a){var y;var b=0;window.setInterval(function(){var x=double_11_marker[a].get('icon');y=double_11[a]['Hour_'+(b)]*25;b=b+1;if(b<23){x.scale=y;double_11_marker[a].set('icon',x);}else{b=0;}},200);}var infowindow;function infoWindowOpen(i){return function(){var string='<div class="taobao_map_infowindow"><div id="village_name">'+double_11[i].village+'</div>'+'<div class="village_province">Province: '+double_11[i].province+'</div>'+'<div class="village_number">Taobao store number: '+double_11[i].storeNumber+'</div>'+'<div class="village_description">'+'</div>';infowindow=new google.maps.InfoWindow({content:string,disableAutoPan:false});infowindow.open(map_2,double_11_marker[i]);}}function infoWindowClose(){return function(){infowindow.close();}}for(var i=0;i<double_11.length;i++){double_11_marker[i].addListener('mouseover',infoWindowOpen(i));double_11_marker[i].addListener('mouseout',infoWindowClose());}}google.maps.event.addDomListener(window,'load',initialize);
